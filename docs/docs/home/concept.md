# TPPTのコンセプト

## なぜTPPTなのか？

生成AIが普及している現在でも、レポートを pptx で提出してほしい、といった要望は多いものです。
（私たちが取り残されているだけなのだろうか？）

tppt は python-pptx のラッパーであり、スライドマスターの型安全な利用などを提供します。

また、簡単に利用でき、直感的に記述されるためのアイデアを投入したものであり、
皆さんの pptx の生成がより安全に、簡単になることを願っています。

## import の削減
もう一度 Quick Start を見てみましょう。
```python
--8<-- "codes/quick_start.py"
```

このコードは、TPPTのみをインポートしています。

極端に少ない import で、PowerPoint のプレゼンテーションを作成できます。

これは、 AI でコード生成をする際、常に tppt を import するだけで済むように配慮することで、
コード生成の成功率を高めることができないか？という実験的なアプローチです。

これの実現には二つのテクニックが利用されています。

### Literal 型の積極的採用

例えば、スライドに追加する Shape の形は従来のように次のように書くことができます。

```python
--8<-- "codes/quick_start_many_import.py"
```

つまり、 `tppt.types.Inches(1)` と同じことを `(1, "in")` と書くことができます。

このように、肩による単位の指定を Literal で表現することで、従来必要であったインポートを減らしています。

これは、書き込みの話であり、プロパティを読み取るには必ず Inches 型に変換されている状態であるため、加減算や比較ができるようになっています。


### 型の引き出し

いくつかの場所で `lambda slide: slide...` のように lambda 式を利用している箇所があります。
これは遅延評価であり、要素を初期化した時点の方を取り出し、それに操作を加えることで要素を完成させます。

このアプローチの特徴は、型を import してから関数の引数に渡すのではなく、
関数の中から型を取り出して利用するというものです。

これにより、コード生成としては import をさらに減らしています。

この方法には別のメリットがあります。
引き出した型に対する操作を関数で切り出すことで、部品を共通化することが容易になります。

```python
--8<-- "codes/apply_sample.py"
```

あなたは `format_text` のような独自の修飾関数を作成し、それを簡単に再利用できます。

### 型安全性
このツールはスライドマスターを元に、新規のスライド作成を行うユーザをメインターゲットとしています。

さて、あなたが私と同じであれば、 python-pptx のスライドマスターに型を与えることに苦労したはずです。

tppt は、 pydantic のような宣言的な型ヒントを利用してスライドマスターに型を与えることができます。

```python
--8<-- "codes/custom_slide_master.py"
```

型定義を自分で書くのは面倒だ？そんな方のために、ささやかなツールも用意しています。

```bash
python -m tppt.tool.ppt2template $YOUR_TEMPLATE.pptx -o $OUTPUT_FILE.py
```

スライドレイアウトのコンストラクタでプレースホルダーの設定をした後、
テキストやピクチャ、表などのデータを記述することができます。

これらの操作は全て型安全です！
