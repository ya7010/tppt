
次のフォルダ構成をとる。

```
pptxr/
├── __init__.py
├── _slide_master.py # SlideMaster クラスを実装するファイル
├── _presentation.py # Presentation クラスを実装するファイル
├── _data.py # データクラスを実装するファイル
├── types/ # python-pptx とは互換性を持つが型安全に再設計したクラス群を配置
│   ├── __init__.py
│   ├── length.py
│   └── color.py
├── _pptxr/ # python-pptx のコードは型安全でないので、ここに配置して抽象クラスを具象させる
│   ├── __init__.py
│   ├── converters.py
│   └── types.py # python-pptx の型に pptxr.types をマッピングさせる
├── _builders/ # ビルダーパターンのクラスを実装する。
│   ├── __init__.py
│   ├── presentation.py
│   └── slide.py
```

## ビルダーパターン

ビルダーパターンは、builder パターンは dataclass で実装された Slide などを生成するクラス。
必ず、 build メソッドを持つ。

```python
class SlideBuilder:
    def text(self, text: str, /, **kwargs: Unpack[TextParams]) -> Self:
        self.bone.append(TextBone(text=text, **kwargs))
        return self

    def image(self, image: Image, /, **kwargs: Unpack[ImageParams]) -> Self:
        self.bone.append(Image(type="image", path=image.path, **kwargs))
        return self

    ...

    def build(self) -> SlideBone:
        pass
```

## Presentation クラス

Presentation クラスは、Presentation を作成するクラス。 Presentation.builder() で作成することが基本。

Presentation は、内部で Slides のデータと、 pptx ファイルを保持する。
save メソッドを呼ぶと、内部のデータを pptx ファイルに保存する。

```python
from pptxr import Presentation

presentation = (
    Presentation.builder()
    .slide(
        TitleSlide(title="Hello, world!").builder()
        .text("Hello, world!", x=(100, "pt"), y=(100, "pt"))
        .image(path="image.png", width=(100, "pt"), height=(100, "pt")),
    )
    .slide(
        TwoColumnSlide(
            title="Hello, world!",
            subtitle="Hello, world!",
            left=Text(text="Hello, world!"),
            right=Image(path="image.png", width=(100, "pt"), height=(100, "pt")),
        )
    )
    .build()
)
```

## スライドマスター

```python
from pptxr import Presentation, SlideTemplate

class MySlideTemplate(SlideTemplate):
    ...


class MyTitleSlide(MySlideTemplate):
    ...


presentation = (
    Presentation.builder(file=__file__ / "slide_master.pptx", slide_template=MySlideTemplate)
    .slide(
        # MySlideTemplate を継承したスライドテンプレートしか代入できないように肩ガードをつけられる
        MyTitleSlide(title="Hello, world!").builder()
        .text("Hello, world!", x=(100, "pt"), y=(100, "pt"))
        .image(path="image.png", width=(100, "pt"), height=(100, "pt")),
    )
    .slide(
        MyTwoColumnSlide.builder(
            title="Hello, world!",
            subtitle="Hello, world!",
            left=Text(text="Hello, world!"),
            right=Image(path="image.png", width=(100, "pt"), height=(100, "pt")),
        )
    )
    .build()
)
```